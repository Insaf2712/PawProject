<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Reports - Attendance System</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link rel="stylesheet" href="styles.css">
</head>
<body>

<div class="navbar">
  <a href="home.html">Home</a>
  <a href="attendance.html">Attendance List</a>
  <a href="add.html">Add Student</a>
  <a href="reports.html" class="active">Reports</a>
  <a href="logout.html">Logout</a>
</div>

<div class="container">
  <div class="content-card">
    <h2>Attendance Reports</h2>
    <p>View comprehensive attendance statistics and analytics.</p>

    <button id="showReportBtn" class="btn btn-primary" style="margin-top: 1.5rem;">ðŸ“Š Show Report</button>

    <div id="reportSection" style="display:none; margin-top: 2.5rem;">
      <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 1.5rem; margin-bottom: 2rem;">
        <div style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); padding: 1.5rem; border-radius: var(--radius-lg); color: white; box-shadow: var(--shadow-lg);">
          <h3 style="color: white; font-size: 0.875rem; text-transform: uppercase; letter-spacing: 0.05em; margin-bottom: 0.5rem;">Total Students</h3>
          <p style="color: white; font-size: 2rem; font-weight: 700; margin: 0;"><span id="totalStudents">0</span></p>
        </div>
        
        <div style="background: linear-gradient(135deg, #10b981 0%, #059669 100%); padding: 1.5rem; border-radius: var(--radius-lg); color: white; box-shadow: var(--shadow-lg);">
          <h3 style="color: white; font-size: 0.875rem; text-transform: uppercase; letter-spacing: 0.05em; margin-bottom: 0.5rem;">Present Students</h3>
          <p style="color: white; font-size: 2rem; font-weight: 700; margin: 0;"><span id="presentStudents">0</span></p>
        </div>
        
        <div style="background: linear-gradient(135deg, #f59e0b 0%, #d97706 100%); padding: 1.5rem; border-radius: var(--radius-lg); color: white; box-shadow: var(--shadow-lg);">
          <h3 style="color: white; font-size: 0.875rem; text-transform: uppercase; letter-spacing: 0.05em; margin-bottom: 0.5rem;">Participated Students</h3>
          <p style="color: white; font-size: 2rem; font-weight: 700; margin: 0;"><span id="participatedStudents">0</span></p>
        </div>
      </div>
      
      <div class="chart-container">
        <canvas id="reportChart"></canvas>
      </div>
    </div>
  </div>
</div>

<script>
document.addEventListener('DOMContentLoaded', function() {
    const showReportBtn = document.getElementById('showReportBtn');
    const reportSection = document.getElementById('reportSection');
    let reportChart = null;

    showReportBtn.addEventListener('click', function() {
        const reportData = JSON.parse(localStorage.getItem('reportData'));

        if (reportData) {
            document.getElementById('totalStudents').textContent = reportData.totalStudents;
            document.getElementById('presentStudents').textContent = reportData.presentStudents;
            document.getElementById('participatedStudents').textContent = reportData.participatedStudents;

            reportSection.style.display = 'block';

            const ctx = document.getElementById('reportChart').getContext('2d');
            if(reportChart) {
                reportChart.destroy();
            }
            reportChart = new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: ['Total Students', 'Present Students', 'Participated Students'],
                    datasets: [{
                        label: 'Attendance Report',
                        data: [reportData.totalStudents, reportData.presentStudents, reportData.participatedStudents],
                        backgroundColor: [
                            'rgba(54, 162, 235, 0.2)',
                            'rgba(75, 192, 192, 0.2)',
                            'rgba(255, 206, 86, 0.2)'
                        ],
                        borderColor: [
                            'rgba(54, 162, 235, 1)',
                            'rgba(75, 192, 192, 1)',
                            'rgba(255, 206, 86, 1)'
                        ],
                        borderWidth: 1
                    }]
                },
                options: {
                    scales: {
                        y: {
                            beginAtZero: true,
                            ticks: {
                                stepSize: 1
                            }
                        }
                    }
                }
            });
        } else {
            alert('Please generate a report from the Attendance List page first.');
        }
    });
});
</script>

</body>
</html>